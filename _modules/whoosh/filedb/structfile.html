<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>whoosh.filedb.structfile &mdash; Whoosh-Reloaded 3.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Whoosh-Reloaded
          </a>
              <div class="version">
                3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction to Whoosh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../schema.html">Designing a schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indexing.html">How to index documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../searching.html">How to search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parsing.html">Parsing user queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../querylang.html">The default query language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dates.html">Indexing and parsing dates/times</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../query.html">Query objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis.html">About analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stemming.html">Stemming, variations, and accent folding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ngrams.html">Indexing and searching N-grams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facets.html">Sorting and faceting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../highlight.html">How to create highlighted search result excerpts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../keywords.html">Query expansion and Key word extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spelling.html">“Did you mean… ?” Correcting errors in user queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fieldcaches.html">Field caches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../batch.html">Tips for speeding up batch indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../threads.html">Concurrency, locking, and versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nested.html">Indexing and searching document hierarchies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../recipes.html">Whoosh recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">Whoosh API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tech/index.html">Technical notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Whoosh-Reloaded</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">whoosh.filedb.structfile</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for whoosh.filedb.structfile</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2009 Matt Chaput. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1">#    1. Redistributions of source code must retain the above copyright notice,</span>
<span class="c1">#       this list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1">#    2. Redistributions in binary form must reproduce the above copyright</span>
<span class="c1">#       notice, this list of conditions and the following disclaimer in the</span>
<span class="c1">#       documentation and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY MATT CHAPUT ``AS IS&#39;&#39; AND ANY EXPRESS OR</span>
<span class="c1"># IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<span class="c1"># MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO</span>
<span class="c1"># EVENT SHALL MATT CHAPUT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,</span>
<span class="c1"># INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,</span>
<span class="c1"># OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span>
<span class="c1"># LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
<span class="c1"># NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,</span>
<span class="c1"># EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">#</span>
<span class="c1"># The views and conclusions contained in the software and documentation are</span>
<span class="c1"># those of the authors and should not be interpreted as representing official</span>
<span class="c1"># policies, either expressed or implied, of Matt Chaput.</span>

<span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dump</span><span class="p">,</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">calcsize</span>

<span class="kn">from</span> <span class="nn">whoosh.system</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_FLOAT_SIZE</span><span class="p">,</span>
    <span class="n">_INT_SIZE</span><span class="p">,</span>
    <span class="n">_LONG_SIZE</span><span class="p">,</span>
    <span class="n">_SHORT_SIZE</span><span class="p">,</span>
    <span class="n">IS_LITTLE</span><span class="p">,</span>
    <span class="n">pack_byte</span><span class="p">,</span>
    <span class="n">pack_float</span><span class="p">,</span>
    <span class="n">pack_int</span><span class="p">,</span>
    <span class="n">pack_long</span><span class="p">,</span>
    <span class="n">pack_sbyte</span><span class="p">,</span>
    <span class="n">pack_uint</span><span class="p">,</span>
    <span class="n">pack_uint_le</span><span class="p">,</span>
    <span class="n">pack_ulong</span><span class="p">,</span>
    <span class="n">pack_ushort</span><span class="p">,</span>
    <span class="n">pack_ushort_le</span><span class="p">,</span>
    <span class="n">unpack_byte</span><span class="p">,</span>
    <span class="n">unpack_float</span><span class="p">,</span>
    <span class="n">unpack_int</span><span class="p">,</span>
    <span class="n">unpack_long</span><span class="p">,</span>
    <span class="n">unpack_sbyte</span><span class="p">,</span>
    <span class="n">unpack_uint</span><span class="p">,</span>
    <span class="n">unpack_uint_le</span><span class="p">,</span>
    <span class="n">unpack_ulong</span><span class="p">,</span>
    <span class="n">unpack_ushort</span><span class="p">,</span>
    <span class="n">unpack_ushort_le</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">whoosh.util.varints</span> <span class="kn">import</span> <span class="n">decode_signed_varint</span><span class="p">,</span> <span class="n">read_varint</span><span class="p">,</span> <span class="n">signed_varint</span><span class="p">,</span> <span class="n">varint</span>

<span class="n">_SIZEMAP</span> <span class="o">=</span> <span class="p">{</span><span class="n">typecode</span><span class="p">:</span> <span class="n">calcsize</span><span class="p">(</span><span class="n">typecode</span><span class="p">)</span> <span class="k">for</span> <span class="n">typecode</span> <span class="ow">in</span> <span class="s2">&quot;bBiIhHqQf&quot;</span><span class="p">}</span>
<span class="n">_ORDERMAP</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;little&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">:</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">}</span>

<span class="n">_types</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;sbyte&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;ushort&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;long&quot;</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">))</span>


<span class="c1"># Main function</span>


<div class="viewcode-block" id="StructFile"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile">[docs]</a><span class="k">class</span> <span class="nc">StructFile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A &quot;structured file&quot; object that wraps a given file object and provides</span>
<span class="sd">    additional methods for writing and reading structured data.</span>

<span class="sd">    This class provides a convenient way to work with structured data in a file.</span>
<span class="sd">    It wraps a file object and adds methods for reading and writing various data</span>
<span class="sd">    types, such as strings, integers, floats, and arrays.</span>

<span class="sd">    Usage:</span>
<span class="sd">    ------</span>
<span class="sd">    To use the StructFile class, create an instance by passing a file object to</span>
<span class="sd">    the constructor:</span>

<span class="sd">    &gt;&gt;&gt; with open(&#39;data.bin&#39;, &#39;wb&#39;) as file:</span>
<span class="sd">    ...     sf = StructFile(file)</span>

<span class="sd">    You can then use the various methods provided by StructFile to read and write</span>
<span class="sd">    data:</span>

<span class="sd">    &gt;&gt;&gt; sf.write_string(&#39;Hello, World!&#39;)</span>
<span class="sd">    &gt;&gt;&gt; sf.write_int(42)</span>
<span class="sd">    &gt;&gt;&gt; sf.write_float(3.14)</span>

<span class="sd">    To read data from the file, use the corresponding read methods:</span>

<span class="sd">    &gt;&gt;&gt; string = sf.read_string()</span>
<span class="sd">    &gt;&gt;&gt; integer = sf.read_int()</span>
<span class="sd">    &gt;&gt;&gt; float_num = sf.read_float()</span>

<span class="sd">    Methods:</span>
<span class="sd">    --------</span>
<span class="sd">    The StructFile class provides the following methods:</span>

<span class="sd">    - read: Read a specified number of bytes from the file.</span>
<span class="sd">    - write: Write data to the file.</span>
<span class="sd">    - read_string: Read a string from the file.</span>
<span class="sd">    - write_string: Write a string to the file.</span>
<span class="sd">    - read_int: Read an integer from the file.</span>
<span class="sd">    - write_int: Write an integer to the file.</span>
<span class="sd">    - read_float: Read a float from the file.</span>
<span class="sd">    - write_float: Write a float to the file.</span>
<span class="sd">    - read_array: Read an array from the file.</span>
<span class="sd">    - write_array: Write an array to the file.</span>
<span class="sd">    - seek: Move the file pointer to a specified position.</span>
<span class="sd">    - tell: Get the current position of the file pointer.</span>
<span class="sd">    - flush: Flush the buffer of the wrapped file.</span>
<span class="sd">    - close: Close the wrapped file.</span>

<span class="sd">    Note:</span>
<span class="sd">    -----</span>
<span class="sd">    The StructFile class is designed to work with binary files. It provides</span>
<span class="sd">    methods for reading and writing various data types in their binary</span>
<span class="sd">    representation. Make sure to open the file in binary mode when using</span>
<span class="sd">    StructFile.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">onclose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a StructFile object.</span>

<span class="sd">        Args:</span>
<span class="sd">            fileobj (file-like object): The file-like object to be wrapped by the StructFile.</span>
<span class="sd">            name (str, optional): The name of the file. Defaults to None.</span>
<span class="sd">            onclose (callable, optional): A callable object to be called when the StructFile is closed. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            file (file-like object): The wrapped file-like object.</span>
<span class="sd">            _name (str): The name of the file.</span>
<span class="sd">            onclose (callable): A callable object to be called when the StructFile is closed.</span>
<span class="sd">            is_closed (bool): Indicates whether the StructFile is closed or not.</span>
<span class="sd">            is_real (bool): Indicates whether the wrapped file-like object has a fileno() method.</span>
<span class="sd">            fileno (method): The fileno() method of the wrapped file-like object.</span>

<span class="sd">        Note:</span>
<span class="sd">            The StructFile is a wrapper around a file-like object that provides additional functionality.</span>
<span class="sd">            It keeps track of the file&#39;s name, whether it is closed, and whether it is a real file object.</span>
<span class="sd">            The fileno() method is only available if the wrapped file-like object has a fileno() method.</span>

<span class="sd">        Usage:</span>
<span class="sd">            # Create a StructFile object</span>
<span class="sd">            fileobj = open(&quot;example.txt&quot;, &quot;r&quot;)</span>
<span class="sd">            struct_file = StructFile(fileobj, &quot;example.txt&quot;, onclose=my_callback)</span>

<span class="sd">            # Access the wrapped file object</span>
<span class="sd">            file = struct_file.file</span>

<span class="sd">            # Check if the StructFile is closed</span>
<span class="sd">            is_closed = struct_file.is_closed</span>

<span class="sd">            # Check if the wrapped file object is a real file object</span>
<span class="sd">            is_real = struct_file.is_real</span>

<span class="sd">            # Call the onclose callback when the StructFile is closed</span>
<span class="sd">            struct_file.onclose = my_callback</span>

<span class="sd">            # Get the fileno of the wrapped file object</span>
<span class="sd">            fileno = struct_file.fileno()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">fileobj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onclose</span> <span class="o">=</span> <span class="n">onclose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_closed</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;fileno&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileno</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">fileno</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a string representation of the StructFile object.</span>

<span class="sd">        The returned string includes the class name and the name of the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A string representation of the StructFile object.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;example.txt&quot;)</span>
<span class="sd">            &gt;&gt;&gt; repr(file)</span>
<span class="sd">            &#39;StructFile(&quot;example.txt&quot;)&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">!r}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of the StructFile object.</span>

<span class="sd">        The string representation is the name of the file associated with the StructFile object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The name of the file associated with the StructFile object.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;example.txt&quot;)</span>
<span class="sd">            &gt;&gt;&gt; str(file)</span>
<span class="sd">            &#39;example.txt&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enter method for the StructFile context manager.</span>

<span class="sd">        This method is automatically called when using the `with` statement to open a StructFile.</span>
<span class="sd">        It returns the StructFile object itself, allowing it to be used within the `with` block.</span>

<span class="sd">        Returns:</span>
<span class="sd">            StructFile: The StructFile object itself.</span>

<span class="sd">        Example:</span>
<span class="sd">            with StructFile(&quot;data.bin&quot;, &quot;rb&quot;) as file:</span>
<span class="sd">                # Perform operations on the file</span>
<span class="sd">                data = file.read(1024)</span>
<span class="sd">                # ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the file when exiting a context manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            exc_type (type): The type of the exception raised, if any.</span>
<span class="sd">            exc_val (Exception): The exception raised, if any.</span>
<span class="sd">            exc_tb (traceback): The traceback object associated with the exception, if any.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Any exception raised during the closing process.</span>

<span class="sd">        This method is automatically called when exiting a `with` statement. It ensures that the file is properly closed,</span>
<span class="sd">        regardless of whether an exception occurred or not. It should not be called directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an iterator over the lines of the file.</span>

<span class="sd">        This method allows the `StructFile` object to be used in a `for` loop or</span>
<span class="sd">        with other iterable constructs. It returns an iterator that yields each</span>
<span class="sd">        line of the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator over the lines of the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; with StructFile(&#39;data.txt&#39;) as file:</span>
<span class="sd">            ...     for line in file:</span>
<span class="sd">            ...         print(line)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>

<div class="viewcode-block" id="StructFile.raw_file"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.raw_file">[docs]</a>    <span class="k">def</span> <span class="nf">raw_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the raw file object associated with this StructFile.</span>

<span class="sd">        This method returns the underlying file object that is used by the StructFile</span>
<span class="sd">        instance. It can be used to perform low-level file operations directly on the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            file: The raw file object associated with this StructFile.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Open a StructFile</span>
<span class="sd">            sf = StructFile(&quot;data.bin&quot;, &quot;rb&quot;)</span>

<span class="sd">            # Get the raw file object</span>
<span class="sd">            f = sf.raw_file()</span>

<span class="sd">            # Perform low-level file operations</span>
<span class="sd">            f.seek(0)</span>
<span class="sd">            data = f.read(1024)</span>

<span class="sd">        Note:</span>
<span class="sd">            Modifying the raw file object directly may lead to unexpected behavior and</span>
<span class="sd">            should be done with caution. It is recommended to use the methods provided by</span>
<span class="sd">            the StructFile class for reading and writing data to the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span></div>

<div class="viewcode-block" id="StructFile.read"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read data from the file.</span>

<span class="sd">        This method reads data from the file and returns it. It delegates the actual reading</span>
<span class="sd">        operation to the underlying file object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        *args: Variable length argument list to be passed to the underlying file object&#39;s read method.</span>
<span class="sd">        **kwargs: Arbitrary keyword arguments to be passed to the underlying file object&#39;s read method.</span>

<span class="sd">        Returns:</span>
<span class="sd">        The data read from the file.</span>

<span class="sd">        Example usage:</span>
<span class="sd">        file = StructFile(&quot;example.txt&quot;)</span>
<span class="sd">        data = file.read(10)  # Read 10 bytes from the file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.readline"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.readline">[docs]</a>    <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read and return a line from the file.</span>

<span class="sd">        This method reads a line from the file and returns it as a string. It delegates the actual reading to the underlying file object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        *args: Variable length argument list to be passed to the underlying file object&#39;s readline method.</span>
<span class="sd">        **kwargs: Arbitrary keyword arguments to be passed to the underlying file object&#39;s readline method.</span>

<span class="sd">        Returns:</span>
<span class="sd">        str: The line read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">        Any exceptions raised by the underlying file object&#39;s readline method.</span>

<span class="sd">        Example:</span>
<span class="sd">        &gt;&gt;&gt; file = StructFile(&quot;example.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; line = file.readline()</span>
<span class="sd">        &gt;&gt;&gt; print(line)</span>
<span class="sd">        &quot;This is an example line.&quot;</span>

<span class="sd">        Note:</span>
<span class="sd">        This method assumes that the file has been opened in text mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.write"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the specified data to the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Variable length argument list.</span>
<span class="sd">            **kwargs: Arbitrary keyword arguments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of bytes written to the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            OSError: If an error occurs while writing to the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            To write a string to the file:</span>

<span class="sd">            &gt;&gt;&gt; file.write(&quot;Hello, World!&quot;)</span>

<span class="sd">        Note:</span>
<span class="sd">            This method delegates the write operation to the underlying file object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.tell"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.tell">[docs]</a>    <span class="k">def</span> <span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the current file position.</span>

<span class="sd">        This method returns the current file position in bytes. It delegates the call to the underlying file object&#39;s `tell()` method.</span>

<span class="sd">        :param args: Optional positional arguments to be passed to the `tell()` method of the underlying file object.</span>
<span class="sd">        :param kwargs: Optional keyword arguments to be passed to the `tell()` method of the underlying file object.</span>
<span class="sd">        :return: The current file position in bytes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.seek"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.seek">[docs]</a>    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the file position to the given offset.</span>

<span class="sd">        This method is a wrapper around the `seek` method of the underlying file object.</span>
<span class="sd">        It allows you to change the current position within the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            *args: Variable length argument list to be passed to the `seek` method.</span>
<span class="sd">            **kwargs: Arbitrary keyword arguments to be passed to the `seek` method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The new absolute position within the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            OSError: If an error occurs while seeking the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            To seek to the beginning of the file:</span>
<span class="sd">            ```</span>
<span class="sd">            file.seek(0)</span>
<span class="sd">            ```</span>

<span class="sd">            To seek to a specific offset from the current position:</span>
<span class="sd">            ```</span>
<span class="sd">            file.seek(10, 1)</span>
<span class="sd">            ```</span>

<span class="sd">            To seek to a specific offset from the end of the file:</span>
<span class="sd">            ```</span>
<span class="sd">            file.seek(-10, 2)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.truncate"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.truncate">[docs]</a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Truncates the file to the specified size.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: Variable length argument list.</span>
<span class="sd">            **kwargs: Arbitrary keyword arguments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The new size of the file after truncation.</span>

<span class="sd">        Raises:</span>
<span class="sd">            OSError: If an error occurs while truncating the file.</span>

<span class="sd">        Note:</span>
<span class="sd">            This method is a wrapper around the `truncate` method of the underlying file object.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Truncate the file to 100 bytes</span>
<span class="sd">            size = file.truncate(100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.flush"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flushes the buffer of the wrapped file. This is a no-op if the</span>
<span class="sd">        wrapped file does not have a flush method.</span>

<span class="sd">        This method ensures that any buffered data in the file is written to the underlying storage.</span>
<span class="sd">        It is recommended to call this method after performing write operations to ensure data integrity.</span>

<span class="sd">        Usage:</span>
<span class="sd">            file = StructFile(...)</span>
<span class="sd">            # Perform write operations</span>
<span class="sd">            file.flush()</span>

<span class="sd">        Note:</span>
<span class="sd">            If the wrapped file does not have a flush method, this method does nothing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;flush&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>

<div class="viewcode-block" id="StructFile.close"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the wrapped file.</span>

<span class="sd">        This method closes the file object that is being wrapped by the StructFile.</span>
<span class="sd">        It is important to close the file after using it to free up system resources</span>
<span class="sd">        and ensure data integrity.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the file is already closed.</span>

<span class="sd">        Usage:</span>
<span class="sd">            To close the StructFile object, simply call the close() method:</span>

<span class="sd">            file = StructFile(...)</span>
<span class="sd">            file.close()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_closed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This file is already closed&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">onclose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">onclose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_closed</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="StructFile.subset"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.subset">[docs]</a>    <span class="k">def</span> <span class="nf">subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a subset of the current StructFile object.</span>

<span class="sd">        Args:</span>
<span class="sd">            offset (int): The starting offset of the subset, in bytes.</span>
<span class="sd">            length (int): The length of the subset, in bytes.</span>
<span class="sd">            name (str, optional): The name of the subset. If not provided, the name of the current StructFile object is used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            StructFile: A new StructFile object representing the subset.</span>

<span class="sd">        Raises:</span>
<span class="sd">            None.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Create a StructFile object</span>
<span class="sd">            sf = StructFile(file, name=&quot;example.txt&quot;)</span>

<span class="sd">            # Get a subset of the StructFile object</span>
<span class="sd">            subset = sf.subset(10, 20, name=&quot;subset.txt&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">whoosh.filedb.compound</span> <span class="kn">import</span> <span class="n">SubFile</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="k">return</span> <span class="n">StructFile</span><span class="p">(</span><span class="n">SubFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">length</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.write_string"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_string">[docs]</a>    <span class="k">def</span> <span class="nf">write_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a string to the wrapped file.</span>

<span class="sd">        This method writes the length of the string first, so you can read the string back</span>
<span class="sd">        without having to know how long it was.</span>

<span class="sd">        :param s: The string to be written.</span>
<span class="sd">        :type s: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_varint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.write_string2"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_string2">[docs]</a>    <span class="k">def</span> <span class="nf">write_string2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a string to the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            s (str): The string to be written.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If the input is not a string.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method writes the length of the string as an unsigned short (2 bytes) followed by the string itself.</span>
<span class="sd">            The length of the string is encoded using the `pack_ushort` function.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile()</span>
<span class="sd">            &gt;&gt;&gt; file.write_string2(&quot;Hello, World!&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_ushort</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.write_string4"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_string4">[docs]</a>    <span class="k">def</span> <span class="nf">write_string4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a string to the file using a custom 4-byte length prefix.</span>

<span class="sd">        Args:</span>
<span class="sd">            s (str): The string to be written.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If the input is not a string.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method writes the length of the string as a 4-byte integer</span>
<span class="sd">            followed by the string itself. The length prefix allows for efficient</span>
<span class="sd">            reading of the string later on.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file.write_string4(&quot;Hello, World!&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.read_string"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_string">[docs]</a>    <span class="k">def</span> <span class="nf">read_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a string from the wrapped file.</span>

<span class="sd">        This method reads a string from the file by first reading the length of the string</span>
<span class="sd">        using the `read_varint` method, and then reading the actual string using the `read` method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The string read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_varint</span><span class="p">())</span></div>

<div class="viewcode-block" id="StructFile.read_string2"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_string2">[docs]</a>    <span class="k">def</span> <span class="nf">read_string2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a string from the file.</span>

<span class="sd">        This method reads a string from the file by first reading the length of the string as an unsigned short,</span>
<span class="sd">        and then reading the actual string data from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The string read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>

<span class="sd">        Usage:</span>
<span class="sd">            string = read_string2()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_ushort</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.read_string4"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_string4">[docs]</a>    <span class="k">def</span> <span class="nf">read_string4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a string from the file.</span>

<span class="sd">        This method reads a string from the file by first reading the length of the string</span>
<span class="sd">        as an integer using the `read_int()` method, and then reading the actual string</span>
<span class="sd">        using the `read()` method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The string read from the file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_int</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.get_string2"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_string2">[docs]</a>    <span class="k">def</span> <span class="nf">get_string2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a string from the file at the given position.</span>

<span class="sd">        Args:</span>
<span class="sd">            pos (int): The position in the file where the string starts.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A tuple containing the string and the position of the next byte after the string.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IndexError: If the position is out of range.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method reads the length of the string from the file, and then reads the string itself.</span>
<span class="sd">            The length of the string is stored as an unsigned short (2 bytes) at the given position.</span>
<span class="sd">            The string is read from the file starting at `pos + 2` and its length is determined by the value read from the file.</span>
<span class="sd">            The returned tuple contains the string and the position of the next byte after the string.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(...)</span>
<span class="sd">            &gt;&gt;&gt; string, next_pos = file.get_string2(10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ushort</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">_SHORT_SIZE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span> <span class="n">base</span> <span class="o">+</span> <span class="n">l</span></div>

<div class="viewcode-block" id="StructFile.get_string4"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_string4">[docs]</a>    <span class="k">def</span> <span class="nf">get_string4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a string from the file at the given position.</span>

<span class="sd">        Args:</span>
<span class="sd">            pos (int): The position in the file where the string starts.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A tuple containing the string and the position of the next byte after the string.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the position is invalid or the string length is negative.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method reads the length of the string from the file at the given position,</span>
<span class="sd">            then reads the string itself from the file. It returns the string and the position</span>
<span class="sd">            of the next byte after the string.</span>

<span class="sd">            The string is read from the file using the `get` method, which reads a specified</span>
<span class="sd">            number of bytes from the file starting at a given position.</span>

<span class="sd">            Example usage:</span>
<span class="sd">            ```</span>
<span class="sd">            string, next_pos = structfile.get_string4(10)</span>
<span class="sd">            ```</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">_INT_SIZE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span> <span class="n">base</span> <span class="o">+</span> <span class="n">l</span></div>

<div class="viewcode-block" id="StructFile.skip_string"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.skip_string">[docs]</a>    <span class="k">def</span> <span class="nf">skip_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Skips a string in the file.</span>

<span class="sd">        This method reads the length of the string from the file using the `read_varint` method,</span>
<span class="sd">        and then seeks forward in the file by that length.</span>

<span class="sd">        Note:</span>
<span class="sd">        - This method assumes that the file pointer is positioned at the start of the string.</span>
<span class="sd">        - The `read_varint` method is responsible for reading the variable-length integer that</span>
<span class="sd">            represents the length of the string.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        IOError: If there is an error reading or seeking in the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_varint</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.write_varint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_varint">[docs]</a>    <span class="k">def</span> <span class="nf">write_varint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a variable-length unsigned integer to the wrapped file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            i (int): The integer value to be written.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If the input value is not an integer.</span>
<span class="sd">            ValueError: If the input value is negative.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method writes a variable-length unsigned integer to the file. The integer value is encoded using a</span>
<span class="sd">            variable-length encoding scheme, where smaller values require fewer bytes to represent. The encoded value</span>
<span class="sd">            is written to the file using the `write` method of the wrapped file object.</span>

<span class="sd">        Example:</span>
<span class="sd">            To write the integer value 42 to the file, you can use the following code:</span>

<span class="sd">            &gt;&gt;&gt; file = StructFile(...)</span>
<span class="sd">            &gt;&gt;&gt; file.write_varint(42)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">varint</span><span class="p">(</span><span class="n">i</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_svarint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_svarint">[docs]</a>    <span class="k">def</span> <span class="nf">write_svarint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a variable-length signed integer to the wrapped file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            i (int): The signed integer to be written.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method writes a variable-length signed integer to the file. The integer is encoded using a</span>
<span class="sd">            variable-length encoding scheme, where the most significant bit of each byte indicates whether</span>
<span class="sd">            there are more bytes to follow. This allows for efficient storage of integers that can have a</span>
<span class="sd">            wide range of values.</span>

<span class="sd">            The method uses the `signed_varint` function to encode the integer before writing it to the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            To write a signed integer to a file:</span>

<span class="sd">            ```</span>
<span class="sd">            file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            file.write_svarint(-42)</span>
<span class="sd">            file.close()</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">signed_varint</span><span class="p">(</span><span class="n">i</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.read_varint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_varint">[docs]</a>    <span class="k">def</span> <span class="nf">read_varint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads a variable-length encoded unsigned integer from the wrapped</span>
<span class="sd">        file.</span>

<span class="sd">        This method reads a variable-length encoded unsigned integer from the</span>
<span class="sd">        file object that is wrapped by this StructFile instance. The integer</span>
<span class="sd">        is encoded using a variable-length encoding scheme, where the number</span>
<span class="sd">        of bytes used to represent the integer depends on its value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The decoded unsigned integer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; with open(&#39;data.bin&#39;, &#39;rb&#39;) as f:</span>
<span class="sd">            ...     sf = StructFile(f)</span>
<span class="sd">            ...     value = sf.read_varint()</span>
<span class="sd">            ...     print(value)</span>
<span class="sd">            42</span>

<span class="sd">        Note:</span>
<span class="sd">            This method assumes that the file object is positioned at the</span>
<span class="sd">            start of the encoded integer. After reading the integer, the file</span>
<span class="sd">            object&#39;s position will be advanced by the number of bytes read.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">read_varint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.read_svarint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_svarint">[docs]</a>    <span class="k">def</span> <span class="nf">read_svarint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads a variable-length encoded signed integer from the wrapped file.</span>

<span class="sd">        This method reads a variable-length encoded signed integer from the wrapped file.</span>
<span class="sd">        It uses the `read_varint` function to read the variable-length encoded integer,</span>
<span class="sd">        and then decodes it as a signed integer using the `decode_signed_varint` function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The decoded signed integer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; value = file.read_svarint()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">decode_signed_varint</span><span class="p">(</span><span class="n">read_varint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_tagint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_tagint">[docs]</a>    <span class="k">def</span> <span class="nf">write_tagint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a sometimes-compressed unsigned integer to the wrapped file.</span>

<span class="sd">        The write_tagint method is used to write an unsigned integer to the file. It uses a</span>
<span class="sd">        sometimes-compressed format for faster writing. The method supports numbers from 0 to</span>
<span class="sd">        2^32-1.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - i (int): The unsigned integer to be written to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">        - Numbers from 0 to 253 are stored in one byte.</span>
<span class="sd">        - Byte 254 indicates that an unsigned 16-bit integer follows.</span>
<span class="sd">        - Byte 255 indicates that an unsigned 32-bit integer follows.</span>

<span class="sd">        Example usage:</span>
<span class="sd">        ```</span>
<span class="sd">        file = StructFile()</span>
<span class="sd">        file.write_tagint(42)</span>
<span class="sd">        ```</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">253</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">65535</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xFE</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">pack_ushort</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xFF</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">pack_uint</span><span class="p">(</span><span class="n">i</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.read_tagint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_tagint">[docs]</a>    <span class="k">def</span> <span class="nf">read_tagint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads a sometimes-compressed unsigned integer from the wrapped file.</span>

<span class="sd">        This method reads an unsigned integer from the file. The integer can be</span>
<span class="sd">        stored in two different formats: a compressed format and a faster but</span>
<span class="sd">        less compressed format.</span>

<span class="sd">        The compressed format uses a single byte to represent the integer. If</span>
<span class="sd">        the first byte read from the file is 254, the integer is stored in the</span>
<span class="sd">        compressed format and can be retrieved using the `read_ushort()` method.</span>
<span class="sd">        If the first byte is 255, the integer is stored in the compressed format</span>
<span class="sd">        and can be retrieved using the `read_uint()` method. Otherwise, the first</span>
<span class="sd">        byte represents the integer itself.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned integer read from the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            Suppose we have a file with the following bytes: [253, 42]. Calling</span>
<span class="sd">            `read_tagint()` on this file will return 253, as the first byte</span>
<span class="sd">            represents the integer itself.</span>

<span class="sd">        Note:</span>
<span class="sd">            This method assumes that the file is opened in binary mode.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">tb</span> <span class="o">==</span> <span class="mi">254</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_ushort</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">tb</span> <span class="o">==</span> <span class="mi">255</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tb</span></div>

<div class="viewcode-block" id="StructFile.write_byte"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_byte">[docs]</a>    <span class="k">def</span> <span class="nf">write_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes a single byte to the wrapped file.</span>

<span class="sd">        This method writes a single byte to the file object that is wrapped by the StructFile instance.</span>
<span class="sd">        It is a shortcut for calling `file.write(chr(n))`.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - n (int): The byte value to be written to the file. Must be an integer between 0 and 255.</span>

<span class="sd">        Raises:</span>
<span class="sd">        - TypeError: If the provided value `n` is not an integer.</span>
<span class="sd">        - ValueError: If the provided value `n` is not within the valid range of 0 to 255.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```</span>
<span class="sd">        with open(&quot;data.bin&quot;, &quot;wb&quot;) as file:</span>
<span class="sd">            struct_file = StructFile(file)</span>
<span class="sd">            struct_file.write_byte(65)  # Writes the ASCII value for &#39;A&#39; to the file</span>
<span class="sd">        ```</span>

<span class="sd">        Note:</span>
<span class="sd">        This method assumes that the file object is opened in binary mode (&#39;b&#39;).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_byte</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.read_byte"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_byte">[docs]</a>    <span class="k">def</span> <span class="nf">read_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a single byte from the file and returns its integer value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The integer value of the byte read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while reading from the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_pickle"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">write_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a pickled representation of obj to the wrapped file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            obj (object): The object to be pickled and written to the file.</span>
<span class="sd">            protocol (int, optional): The pickling protocol to use. Default is -1.</span>

<span class="sd">        Raises:</span>
<span class="sd">            pickle.PicklingError: If an error occurs during pickling.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method uses the `pickle.dump()` function to write a pickled representation</span>
<span class="sd">            of the given object to the file. The pickling protocol determines the format</span>
<span class="sd">            in which the object is serialized. The default protocol (-1) uses the highest</span>
<span class="sd">            available protocol supported by the Python interpreter.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Create a StructFile object</span>
<span class="sd">            file = StructFile(&quot;data.bin&quot;)</span>

<span class="sd">            # Write a list object to the file using pickle</span>
<span class="sd">            data = [1, 2, 3, 4, 5]</span>
<span class="sd">            file.write_pickle(data)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">protocol</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.read_pickle"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a pickled object from the wrapped file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            object: The pickled object read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            EOFError: If the end of the file is reached before a pickled object is found.</span>
<span class="sd">            pickle.UnpicklingError: If there is an error while unpickling the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.write_sbyte"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_sbyte">[docs]</a>    <span class="k">def</span> <span class="nf">write_sbyte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a signed byte to the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): The signed byte value to write.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - The signed byte value should be within the range of -128 to 127.</span>
<span class="sd">            - The file should be opened in binary mode before calling this method.</span>

<span class="sd">        Example:</span>
<span class="sd">            To write a signed byte value of -42 to the file:</span>

<span class="sd">            &gt;&gt;&gt; file.write_sbyte(-42)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_sbyte</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_int"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_int">[docs]</a>    <span class="k">def</span> <span class="nf">write_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an integer to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - n (int): The integer to be written.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        - TypeError: If the input is not an integer.</span>

<span class="sd">        Notes:</span>
<span class="sd">        - This method writes the integer to the file using the pack_int function.</span>
<span class="sd">        - The pack_int function converts the integer into a binary representation.</span>
<span class="sd">        - The binary representation is then written to the file.</span>
<span class="sd">        - If the input is not an integer, a TypeError is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_uint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_uint">[docs]</a>    <span class="k">def</span> <span class="nf">write_uint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an unsigned integer to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            n (int): The unsigned integer to write.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method writes the unsigned integer `n` to the file. The integer is encoded using the `pack_uint` function.</span>

<span class="sd">        Example:</span>
<span class="sd">            file.write_uint(42)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_uint</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_uint_le"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_uint_le">[docs]</a>    <span class="k">def</span> <span class="nf">write_uint_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an unsigned integer in little-endian format to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - n (int): The unsigned integer to write.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        - TypeError: If the input is not an integer.</span>
<span class="sd">        - ValueError: If the input is a negative integer.</span>

<span class="sd">        Example:</span>
<span class="sd">        &gt;&gt;&gt; file.write_uint_le(42)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_uint_le</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_ushort"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_ushort">[docs]</a>    <span class="k">def</span> <span class="nf">write_ushort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an unsigned short integer (2 bytes) to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - n (int): The unsigned short integer to be written.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        - IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Usage:</span>
<span class="sd">        file.write_ushort(42)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_ushort</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_ushort_le"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_ushort_le">[docs]</a>    <span class="k">def</span> <span class="nf">write_ushort_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an unsigned short integer (2 bytes) in little-endian byte order to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - n (int): The unsigned short integer to be written.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        - IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Usage:</span>
<span class="sd">        file.write_ushort_le(65535)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_ushort_le</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_long"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_long">[docs]</a>    <span class="k">def</span> <span class="nf">write_long</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a long integer to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - n (int): The long integer to be written.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        - IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">        - This method writes the long integer to the file using the pack_long function.</span>
<span class="sd">        - The pack_long function converts the long integer into a binary representation.</span>
<span class="sd">        - The binary representation is then written to the file.</span>
<span class="sd">        - If an error occurs while writing to the file, an IOError is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_long</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_ulong"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_ulong">[docs]</a>    <span class="k">def</span> <span class="nf">write_ulong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an unsigned long integer to the file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            n (int): The unsigned long integer to write.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method writes an unsigned long integer to the file using the pack_ulong function.</span>
<span class="sd">            The pack_ulong function converts the integer into a byte string representation according to the platform&#39;s byte order.</span>
<span class="sd">            The resulting byte string is then written to the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            To write the unsigned long integer 123456789 to the file:</span>

<span class="sd">            &gt;&gt;&gt; file.write_ulong(123456789)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_ulong</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_float"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_float">[docs]</a>    <span class="k">def</span> <span class="nf">write_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a floating-point number to the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (float): The floating-point number to write.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while writing to the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method uses the `pack_float` function to convert the floating-point number</span>
<span class="sd">            into a binary representation before writing it to the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;, &quot;wb&quot;)</span>
<span class="sd">            &gt;&gt;&gt; file.write_float(3.14)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pack_float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="StructFile.write_array"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.write_array">[docs]</a>    <span class="k">def</span> <span class="nf">write_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arry</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write an array to the file.</span>

<span class="sd">        This method writes the given array to the file. If the system is little-endian,</span>
<span class="sd">        the array is first byte-swapped before writing. If the file is a real file,</span>
<span class="sd">        the array is written using the `tofile()` method. Otherwise, the array is</span>
<span class="sd">        converted to bytes and written using the `write()` method.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - arry (array): The array to be written to the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">IS_LITTLE</span><span class="p">:</span>
            <span class="n">arry</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>
            <span class="n">arry</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="n">arry</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arry</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span></div>

<div class="viewcode-block" id="StructFile.read_sbyte"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_sbyte">[docs]</a>    <span class="k">def</span> <span class="nf">read_sbyte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a signed byte from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The signed byte value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while reading from the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method reads a single byte from the file and interprets it as a signed value.</span>
<span class="sd">            The byte is unpacked using the `unpack_sbyte` function, which returns a tuple.</span>
<span class="sd">            The first element of the tuple is the signed byte value, which is then returned.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; byte = file.read_sbyte()</span>
<span class="sd">            &gt;&gt;&gt; print(byte)</span>
<span class="sd">            -42</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_sbyte</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_int"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_int">[docs]</a>    <span class="k">def</span> <span class="nf">read_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an integer value from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The integer value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_INT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_uint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_uint">[docs]</a>    <span class="k">def</span> <span class="nf">read_uint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an unsigned integer from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned integer read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_INT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_uint_le"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_uint_le">[docs]</a>    <span class="k">def</span> <span class="nf">read_uint_le</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an unsigned integer from the file using little-endian byte order.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned integer read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while reading from the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method reads an unsigned integer from the file using little-endian byte order.</span>
<span class="sd">            It assumes that the file is opened in binary mode.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; value = file.read_uint_le()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_uint_le</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_INT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_ushort"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_ushort">[docs]</a>    <span class="k">def</span> <span class="nf">read_ushort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an unsigned short (2 bytes) from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned short value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_ushort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_SHORT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_ushort_le"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_ushort_le">[docs]</a>    <span class="k">def</span> <span class="nf">read_ushort_le</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an unsigned short (2 bytes) from the file in little-endian byte order.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned short value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; value = file.read_ushort_le()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_ushort_le</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_SHORT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_long"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_long">[docs]</a>    <span class="k">def</span> <span class="nf">read_long</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a long integer from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The long integer read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while reading from the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method reads a long integer from the file using the `read` method of the file object.</span>
<span class="sd">            The long integer is unpacked from the binary data using the `unpack_long` function.</span>
<span class="sd">            The `unpack_long` function returns a tuple, and the first element of the tuple is returned as the result.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; value = file.read_long()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_long</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_LONG_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_ulong"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_ulong">[docs]</a>    <span class="k">def</span> <span class="nf">read_ulong</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an unsigned long integer from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned long integer read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while reading from the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method reads a fixed-size unsigned long integer from the file. The size of the</span>
<span class="sd">            unsigned long integer is determined by the `_LONG_SIZE` constant.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; value = file.read_ulong()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_ulong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_LONG_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_float"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_float">[docs]</a>    <span class="k">def</span> <span class="nf">read_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a single floating-point number from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The floating-point number read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If an error occurs while reading from the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">_FLOAT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.read_array"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.read_array">[docs]</a>    <span class="k">def</span> <span class="nf">read_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecode</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read an array of elements from the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            typecode (str): The typecode of the array elements.</span>
<span class="sd">            length (int): The number of elements to read.</span>

<span class="sd">        Returns:</span>
<span class="sd">            array: The array of elements read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If there is an error reading from the file.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - If the file is in &quot;real&quot; mode, the array is read using the `fromfile` method of the array object.</span>
<span class="sd">            - If the file is not in &quot;real&quot; mode, the array is read using the `read` method of the file object and then converted to an array using the `frombytes` method of the array object.</span>
<span class="sd">            - If the system is little-endian, the byte order of the array is swapped using the `byteswap` method of the array object.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Create a StructFile object</span>
<span class="sd">            file = StructFile(&quot;data.bin&quot;)</span>

<span class="sd">            # Read an array of integers from the file</span>
<span class="sd">            arr = file.read_array(&#39;i&#39;, 10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">typecode</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length</span> <span class="o">*</span> <span class="n">_SIZEMAP</span><span class="p">[</span><span class="n">typecode</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">IS_LITTLE</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">a</span></div>

<div class="viewcode-block" id="StructFile.get"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a specified number of bytes from the file starting at the given position.</span>

<span class="sd">        Args:</span>
<span class="sd">            position (int): The position in the file to start reading from.</span>
<span class="sd">            length (int): The number of bytes to read from the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: The bytes read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            OSError: If an error occurs while reading from the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; data = file.get(10, 20)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="StructFile.get_byte"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_byte">[docs]</a>    <span class="k">def</span> <span class="nf">get_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a single byte from the file at the specified position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            position (int): The position in the file from which to retrieve the byte.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The byte value at the specified position.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IndexError: If the position is out of range.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Create a StructFile object</span>
<span class="sd">            file = StructFile(&quot;data.bin&quot;)</span>

<span class="sd">            # Get the byte at position 10</span>
<span class="sd">            byte = file.get_byte(10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_byte</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_sbyte"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_sbyte">[docs]</a>    <span class="k">def</span> <span class="nf">get_sbyte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a signed byte (8-bit integer) from the file at the specified position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - position (int): The position in the file from which to read the signed byte.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - int: The signed byte value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">        - IndexError: If the position is out of range.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```</span>
<span class="sd">        file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">        byte = file.get_sbyte(10)</span>
<span class="sd">        print(byte)  # Output: -42</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_sbyte</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_int"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_int">[docs]</a>    <span class="k">def</span> <span class="nf">get_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves an integer value from the file at the specified position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            position (int): The position in the file from which to retrieve the integer value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The integer value retrieved from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IndexError: If the position is out of range.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">_INT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_uint"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_uint">[docs]</a>    <span class="k">def</span> <span class="nf">get_uint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves an unsigned integer from the file at the given position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - position (int): The position in the file from which to read the unsigned integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - int: The unsigned integer value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">        - IndexError: If the position is out of range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">_INT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_ushort"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_ushort">[docs]</a>    <span class="k">def</span> <span class="nf">get_ushort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves an unsigned short integer (2 bytes) from the file at the specified position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - position (int): The position in the file from which to read the unsigned short integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - ushort (int): The unsigned short integer value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">        - IndexError: If the position is out of range.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```</span>
<span class="sd">        file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">        ushort_value = file.get_ushort(10)</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_ushort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">_SHORT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_long"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_long">[docs]</a>    <span class="k">def</span> <span class="nf">get_long</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a long integer value from the file at the given position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            position (int): The position in the file from which to read the long integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The long integer value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the position is out of bounds or if the file is not open.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - This method reads a long integer value from the file at the specified position.</span>
<span class="sd">            - The file must be open before calling this method.</span>
<span class="sd">            - The position must be a valid position within the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_long</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">_LONG_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_ulong"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_ulong">[docs]</a>    <span class="k">def</span> <span class="nf">get_ulong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves an unsigned long integer from the file at the specified position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            position (int): The position in the file from which to read the unsigned long integer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The unsigned long integer value read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IndexError: If the position is out of range.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - The unsigned long integer is read from the file using the `get` method.</span>
<span class="sd">            - The `unpack_ulong` function is used to convert the byte string to an unsigned long integer.</span>
<span class="sd">            - Only the first value of the unpacked result is returned.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Create a StructFile object</span>
<span class="sd">            file = StructFile(&quot;data.bin&quot;)</span>

<span class="sd">            # Read an unsigned long integer from the file at position 100</span>
<span class="sd">            value = file.get_ulong(100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_ulong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">_LONG_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_float"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_float">[docs]</a>    <span class="k">def</span> <span class="nf">get_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a float value from the file at the specified position.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            position (int): The position in the file where the float value is located.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The float value retrieved from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IndexError: If the position is out of range.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unpack_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">_FLOAT_SIZE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="StructFile.get_array"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.StructFile.get_array">[docs]</a>    <span class="k">def</span> <span class="nf">get_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">typecode</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads an array of elements from the file starting at the given position.</span>

<span class="sd">        Args:</span>
<span class="sd">            position (int): The position in the file to start reading from.</span>
<span class="sd">            typecode (str): The typecode of the elements in the array.</span>
<span class="sd">            length (int): The number of elements to read.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list containing the elements read from the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            OSError: If there is an error reading the file.</span>

<span class="sd">        Example:</span>
<span class="sd">            To read an array of 10 integers starting from position 100 in the file:</span>

<span class="sd">            &gt;&gt;&gt; file = StructFile(&quot;data.bin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; array = file.get_array(100, &#39;i&#39;, 10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_array</span><span class="p">(</span><span class="n">typecode</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BufferFile"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.BufferFile">[docs]</a><span class="k">class</span> <span class="nc">BufferFile</span><span class="p">(</span><span class="n">StructFile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing a file stored in memory as a buffer.</span>

<span class="sd">    This class provides methods to manipulate and retrieve data from the buffer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        _buf (bytes): The buffer containing the file data.</span>
<span class="sd">        _name (str): The name of the file.</span>
<span class="sd">        file (BytesIO): A BytesIO object representing the file.</span>
<span class="sd">        onclose (callable): A callback function to be called when the file is closed.</span>
<span class="sd">        is_real (bool): Indicates whether the file is a real file or a buffer.</span>
<span class="sd">        is_closed (bool): Indicates whether the file is closed.</span>

<span class="sd">    Methods:</span>
<span class="sd">        __init__(self, buf, name=None, onclose=None): Initializes a BufferFile object.</span>
<span class="sd">        subset(self, position, length, name=None): Creates a new BufferFile object representing a subset of the current file.</span>
<span class="sd">        get(self, position, length): Retrieves a portion of the file data.</span>
<span class="sd">        get_array(self, position, typecode, length): Retrieves an array of data from the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BufferFile.__init__"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.BufferFile.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">onclose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a BufferFile object.</span>

<span class="sd">        Args:</span>
<span class="sd">            buf (bytes): The buffer containing the file data.</span>
<span class="sd">            name (str, optional): The name of the file. Defaults to None.</span>
<span class="sd">            onclose (callable, optional): A callback function to be called when the file is closed. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buf</span> <span class="o">=</span> <span class="n">buf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onclose</span> <span class="o">=</span> <span class="n">onclose</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_closed</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BufferFile.subset"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.BufferFile.subset">[docs]</a>    <span class="k">def</span> <span class="nf">subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new BufferFile object that represents a subset of the current file.</span>

<span class="sd">        Args:</span>
<span class="sd">            position (int): The starting position of the subset.</span>
<span class="sd">            length (int): The length of the subset.</span>
<span class="sd">            name (str, optional): The name of the new file. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BufferFile: A new BufferFile object representing the subset of the current file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="k">return</span> <span class="n">BufferFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">length</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="BufferFile.get"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.BufferFile.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a portion of the file data.</span>

<span class="sd">        Args:</span>
<span class="sd">            position (int): The starting position of the data.</span>
<span class="sd">            length (int): The length of the data to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: The requested portion of the file data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buf</span><span class="p">[</span><span class="n">position</span> <span class="p">:</span> <span class="n">position</span> <span class="o">+</span> <span class="n">length</span><span class="p">])</span></div>

<div class="viewcode-block" id="BufferFile.get_array"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.BufferFile.get_array">[docs]</a>    <span class="k">def</span> <span class="nf">get_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">typecode</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves an array of data from the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            position (int): The starting position of the array.</span>
<span class="sd">            typecode (str): The typecode of the array elements.</span>
<span class="sd">            length (int): The length of the array.</span>

<span class="sd">        Returns:</span>
<span class="sd">            array: An array of data retrieved from the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">typecode</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">length</span> <span class="o">*</span> <span class="n">_SIZEMAP</span><span class="p">[</span><span class="n">typecode</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">IS_LITTLE</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">a</span></div></div>


<div class="viewcode-block" id="ChecksumFile"><a class="viewcode-back" href="../../../api/filedb/structfile.html#whoosh.filedb.structfile.ChecksumFile">[docs]</a><span class="k">class</span> <span class="nc">ChecksumFile</span><span class="p">(</span><span class="n">StructFile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A file-like object that calculates a checksum of the data read or written.</span>

<span class="sd">    This class inherits from StructFile and provides additional functionality to calculate a checksum</span>
<span class="sd">    using the CRC32 algorithm from the zlib module. The checksum is updated as data is read or written.</span>

<span class="sd">    Note: This class does not support seeking.</span>

<span class="sd">    Usage:</span>
<span class="sd">    - Create an instance of ChecksumFile by passing the file path or file object to the constructor.</span>
<span class="sd">    - Read or write data using the file-like methods provided by ChecksumFile.</span>
<span class="sd">    - Call the checksum() method to get the calculated checksum.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```</span>
<span class="sd">    with ChecksumFile(&quot;data.txt&quot;, &quot;rb&quot;) as file:</span>
<span class="sd">        data = file.read(1024)</span>
<span class="sd">        print(file.checksum())</span>
<span class="sd">    ```</span>

<span class="sd">    Attributes:</span>
<span class="sd">    - _check: The current checksum value.</span>
<span class="sd">    - _crc32: The CRC32 function from the zlib module.</span>

<span class="sd">    Methods:</span>
<span class="sd">    - __iter__(): Returns an iterator over the lines of the file.</span>
<span class="sd">    - seek(): Raises a ValueError as seeking is not supported.</span>
<span class="sd">    - read(): Reads data from the file and updates the checksum.</span>
<span class="sd">    - write(): Writes data to the file and updates the checksum.</span>
<span class="sd">    - checksum(): Returns the calculated checksum.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">StructFile</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_crc32</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="s2">&quot;zlib&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">crc32</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crc32</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">line</span>

    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot seek on a ChecksumFile&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read data from the file and update the checksum.</span>

<span class="sd">        Args:</span>
<span class="sd">        - *args: Variable length argument list to pass to the underlying file&#39;s read() method.</span>
<span class="sd">        - **kwargs: Arbitrary keyword arguments to pass to the underlying file&#39;s read() method.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - b: The read data.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crc32</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write data to the file and update the checksum.</span>

<span class="sd">        Args:</span>
<span class="sd">        - b: The data to write.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crc32</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the calculated checksum.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - The calculated checksum as an unsigned 32-bit integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2007-2012 Matt Chaput.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>